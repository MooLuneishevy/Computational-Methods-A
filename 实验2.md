## 实验内容

实验内容如下：

线性方程组 $Ax=b$ 的常数项发生扰动时，满足下面的式子。

$$\frac{||\delta x||_p}{||x||_p}\le(||A||_p\cdot ||A^{-1}||_p)\cdot\frac{||\delta b||_p}{||b||_p}$$

试构造非奇异矩阵 $A$ 和常数项 $b$ ,对常数项进行100次随机扰动，分析扰动带来的误差。

做散点分布图，横轴为 $\frac{||\delta b||}{||b||}$ ,纵轴为 $\frac{||\delta x||}{||x||}$ ,并与上面的估计式进行比较。

## 实验设计

首先，编写函数<code>Gausscolumn(A,b)</code>实现利用列主元消元法，来求解给定的方程组 $Ax=b$ 并返回得到的解 $x$ 。

随后，编写函数<code>RandomPerturbation(A,b)</code>实现对常数项进行100次随机扰动，并做出散点分布图以及直线 $(||A||_p\cdot ||A^{-1}||_p)y=x$ ,如果散点均分布在直线以下，即证明了给出的估计式：

$$\frac{||\delta x||_p}{||x||_p}\le(||A||_p\cdot ||A^{-1}||_p)\cdot\frac{||\delta b||_p}{||b||_p}$$

## 编程实现

在<code>Gausscolumn(A,b)</code>函数中，遍历所有的行，在每次消元之前首先选择当前列中最大值，以保证求解得到的 $x$ 误差尽可能小。最后，结果以向量形式返回。

在<code>RandomPerturbation(A,b)</code>函数中，扰动项设定为<code>rand(size_i,1)-0.5</code>,<code>rand()</code>函数默认生成0到1之间的随机数，而-0.5将其均值约束至0。

随后在迭代的过程中，以<code>axis_1,axis_2</code>向量来记录横轴 $\frac{||\delta b||}{||b||}$ ,纵轴 $\frac{||\delta x||}{||x||}$ 。最终调用<code>plot()</code>函数，来绘制图像。

````matlab
function [x]=Gausscolumn(A,b)
    [size_i,size_j]=size(A);
    for j=1:size_i
        [posi_x,posi_y]=max(abs(A(j:size_i,j)));
        posi_y=posi_y+j-1;
        A([posi_y,j],:)=A([j,posi_y],:);
        b([posi_y,j])=b([j,posi_y]);
        for i=j+1:size_i
            d=-A(i,j)/A(j,j);
            A(i,:)=A(i,:)+d*A(j,:);
            b(i)=b(i)+d*b(j);
        end
    end
    x=zeros(size_i,1);
    x(size_i)=b(size_i)/A(size_i,size_i);
    for i=size_i-1:-1:1
        x(i)=(b(i)-sum(x(i+1:size_i).*A(i,i+1:size_i)'))/A(i,i);
    end
end
````

````matlab
function RandomPerturbation(A,b)
    [size_i,size_j]=size(A);
    prex=Gausscolumn(A,b);
    norm_b=norm(b);
    norm_prex=norm(prex);
    axis_1=zeros(100,1);
    axis_2=zeros(100,1);
    for i=1:100
        delta=rand(size_i,1)-0.5;
        x=Gausscolumn(A,b+delta);
        axis_1(i)=norm(x-prex)/norm_prex;
        axis_2(i)=norm(delta)/norm_b;
    end
    plot(axis_1,axis_2,'bo');
    conf=norm(A)*norm(A^-1);
    hold;
    max_x=max(axis_1);
    max_y=max(axis_2);
    plot([0,max_x],[0,max_y*conf],'-r*');
    xlabel('delta of b');
    ylabel('delta of x');
    title('exp2');
    grid on;
end
````

## 计算结果

初值设定为 $A=\begin{bmatrix}1&0&1\\\\0&2&1\\\\0&0&1\end{bmatrix},b=\begin{bmatrix}6\\\\5\\\\4\end{bmatrix}$

## 实验结果及思考

可以看出：散点均分布在直线以下，即给出的估计式正确。

$$\frac{||\delta x||_p}{||x||_p}\le(||A||_p\cdot ||A^{-1}||_p)\cdot\frac{||\delta b||_p}{||b||_p}$$

通过实验，我进一步明确了在实际应用中，控制误差传播的重要性。在实现列主元消元法和随机扰动的函数中，也对octave中的函数用于方法有了更深的理解与体会。